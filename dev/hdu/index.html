<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>HDU · CFITSIO.jl</title><meta name="title" content="HDU · CFITSIO.jl"/><meta property="og:title" content="HDU · CFITSIO.jl"/><meta property="twitter:title" content="HDU · CFITSIO.jl"/><meta name="description" content="Documentation for CFITSIO.jl."/><meta property="og:description" content="Documentation for CFITSIO.jl."/><meta property="twitter:description" content="Documentation for CFITSIO.jl."/><meta property="og:url" content="https://juliaastro.github.io/CFITSIO.jl/hdu/"/><meta property="twitter:url" content="https://juliaastro.github.io/CFITSIO.jl/hdu/"/><link rel="canonical" href="https://juliaastro.github.io/CFITSIO.jl/hdu/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CFITSIO.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../types/">Type Conversions</a></li><li><a class="tocitem" href="../file/">File</a></li><li class="is-active"><a class="tocitem" href>HDU</a><ul class="internal"><li><a class="tocitem" href="#HDU-Routines"><span>HDU Routines</span></a></li></ul></li><li><a class="tocitem" href="../header/">Header</a></li><li><a class="tocitem" href="../image/">Image</a></li><li><a class="tocitem" href="../table/">Table</a></li><li><a class="tocitem" href="../misc/">Miscellaneous</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>HDU</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>HDU</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaAstro/CFITSIO.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/master/docs/src/hdu.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="HDU-Routines"><a class="docs-heading-anchor" href="#HDU-Routines">HDU Routines</a><a id="HDU-Routines-1"></a><a class="docs-heading-anchor-permalink" href="#HDU-Routines" title="Permalink"></a></h2><p>The functions described in this section change the current HDU and to find their number and type. The following is a short example which shows how to use them:</p><pre><code class="language-julia hljs">num = fits_get_num_hdus(f)
println(&quot;Number of HDUs in the file: &quot;, num)

for i = 1:num
    hdu_type = fits_movabs_hdu(f, i)
    println(i, &quot;) hdu_type = &quot;, hdu_type)
end</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_get_num_hdus" href="#CFITSIO.fits_get_num_hdus"><code>CFITSIO.fits_get_num_hdus</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_get_num_hdus(f::FITSFile)</code></pre><p>Return the number of HDUs in the file.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_img(f, [1, 2, 3]);

julia&gt; fits_create_binary_tbl(f, 0, [(&quot;col1&quot;, &quot;1J&quot;, &quot;units&quot;)]);

julia&gt; close(f)

julia&gt; f = fits_open_file(fname, CFITSIO.READONLY);

julia&gt; fits_get_num_hdus(f)
2

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/514542da3a88d61ed2d08e6a390298fcbe94716c/src/CFITSIO.jl#L4691-L4715">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_get_hdu_num" href="#CFITSIO.fits_get_hdu_num"><code>CFITSIO.fits_get_hdu_num</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_get_hdu_num(f::FITSFile)</code></pre><p>Return the index of the current HDU in the FITS file. The primary HDU is numbered 1, the first extension HDU is numbered 2, etc.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_create_binary_tbl(f, 0, [(&quot;col1&quot;, &quot;1J&quot;), (&quot;col2&quot;, &quot;1E&quot;)])

julia&gt; fits_get_hdu_num(f)
2

julia&gt; fits_movabs_hdu(f, 1) # move to the primary HDU
:image_hdu

julia&gt; fits_get_hdu_num(f)
1

julia&gt; fits_movabs_hdu(f, 2) # move to the binary table HDU
:binary_table

julia&gt; fits_get_hdu_num(f)
2

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/514542da3a88d61ed2d08e6a390298fcbe94716c/src/CFITSIO.jl#L2237-L2270">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_get_hdu_type" href="#CFITSIO.fits_get_hdu_type"><code>CFITSIO.fits_get_hdu_type</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_get_hdu_type(f::FITSFile)</code></pre><p>Return the type of the current HDU as a symbol. Possible symbols are: <code>:image_hdu</code>, <code>:ascii_table</code>, or <code>:binary_table</code>. If the HDU is not one of these types, it returns <code>:unknown</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_get_hdu_type(f)
:image_hdu

julia&gt; fits_create_binary_tbl(f, 0, [(&quot;col1&quot;, &quot;1J&quot;), (&quot;col2&quot;, &quot;1E&quot;)])

julia&gt; fits_get_hdu_type(f)
:binary_table

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/514542da3a88d61ed2d08e6a390298fcbe94716c/src/CFITSIO.jl#L2278-L2302">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_movabs_hdu" href="#CFITSIO.fits_movabs_hdu"><code>CFITSIO.fits_movabs_hdu</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_movabs_hdu(f::FITSFile, hduNum::Integer)</code></pre><p>Change the current HDU to the value specified by <code>hduNum</code>, and return a symbol describing the type of the HDU.</p><p>Possible symbols are: <code>image_hdu</code>, <code>ascii_table</code>, or <code>binary_table</code>. The value of <code>hduNum</code> must range between 1 and the value returned by <a href="#CFITSIO.fits_get_num_hdus"><code>fits_get_num_hdus</code></a>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_create_binary_tbl(f, 0, [(&quot;col1&quot;, &quot;1J&quot;), (&quot;col2&quot;, &quot;1E&quot;)])

julia&gt; fits_movabs_hdu(f, 2)
:binary_table

julia&gt; fits_movabs_hdu(f, 1)
:image_hdu

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/514542da3a88d61ed2d08e6a390298fcbe94716c/src/CFITSIO.jl#L2095-L2123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_movrel_hdu" href="#CFITSIO.fits_movrel_hdu"><code>CFITSIO.fits_movrel_hdu</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_movrel_hdu(f::FITSFile, hduNum::Integer)</code></pre><p>Change the current HDU by moving forward or backward by <code>hduNum</code> HDUs (positive means forward), and return the same as <a href="#CFITSIO.fits_movabs_hdu"><code>fits_movabs_hdu</code></a>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_create_binary_tbl(f, 0, [(&quot;col1&quot;, &quot;1J&quot;), (&quot;col2&quot;, &quot;1E&quot;)])

julia&gt; fits_movabs_hdu(f, 2)
:binary_table

julia&gt; fits_movrel_hdu(f, -1) # move back to the image HDU
:image_hdu

julia&gt; fits_movrel_hdu(f, 1) # move forward to the binary table HDU
:binary_table

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/514542da3a88d61ed2d08e6a390298fcbe94716c/src/CFITSIO.jl#L2126-L2153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_movnam_hdu" href="#CFITSIO.fits_movnam_hdu"><code>CFITSIO.fits_movnam_hdu</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_movnam_hdu(f::FITSFile, extname::String, extver::Integer=0,
                hdu_type_int::Integer=-1)</code></pre><p>Change the current HDU by moving to the (first) HDU which has the specified extension type and EXTNAME and EXTVER keyword values (or HDUNAME and HDUVER keywords).</p><p>If <code>extver</code> is 0 (the default) then the EXTVER keyword is ignored and the first HDU with a matching EXTNAME (or HDUNAME) keyword will be found. If <code>hdu_type_int</code> is -1 (the default) only the extname and extver values will be used to locate the correct extension. If no matching HDU is found in the file, the current HDU will remain unchanged.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_write_key(f, &quot;EXTNAME&quot;, &quot;MyImage&quot;, &quot;Name of the Image&quot;)

julia&gt; fits_create_binary_tbl(f, 0, [(&quot;col1&quot;, &quot;1J&quot;), (&quot;col2&quot;, &quot;1E&quot;)], &quot;MyTable&quot;)

julia&gt; fits_movnam_hdu(f, &quot;MyImage&quot;)

julia&gt; fits_get_hdu_type(f), fits_get_hdu_num(f)
(:image_hdu, 1)

julia&gt; fits_movnam_hdu(f, &quot;MyTable&quot;)

julia&gt; fits_get_hdu_type(f), fits_get_hdu_num(f)
(:binary_table, 2)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/514542da3a88d61ed2d08e6a390298fcbe94716c/src/CFITSIO.jl#L2177-L2214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_copy_file" href="#CFITSIO.fits_copy_file"><code>CFITSIO.fits_copy_file</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_copy_file(fin::FITSFile, fout::FITSFile, previous::Bool, current::Bool, following::Bool)</code></pre><p>Copy all or a part of the HDUs from the input file <code>fin</code>, and append them to the output file <code>fout</code>. The flags <code>previous</code>, <code>current</code> and <code>following</code> specify which HDUs are to be copied.</p><ul><li>If <code>previous</code> is true, all the HDUs prior to the current input HDU are copied.</li><li>If <code>current</code> is true, the current input HDU is copied.</li><li>If <code>following</code> is true, all the HDUs following the current input HDU are copied.</li></ul><p>These flags may be combined, so if all are set to <code>true</code> then all the HDUs are copied from <code>fin</code> to <code>fout</code>.</p><p>On exit, the input is unchanged, and the last HDU in the output is set as the current HDU.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname_in = joinpath(mktempdir(), &quot;test_in.fits&quot;);

julia&gt; fname_out = joinpath(mktempdir(), &quot;test_out.fits&quot;);

julia&gt; fin = fits_create_file(fname_in);

julia&gt; fits_create_empty_img(fin);

julia&gt; fits_write_key(fin, &quot;KEY1&quot;, 1, &quot;First keyword&quot;);

julia&gt; fits_create_binary_tbl(fin, 0, [(&quot;col1&quot;, &quot;1J&quot;), (&quot;col2&quot;, &quot;1E&quot;)], &quot;MyTable&quot;);

julia&gt; fout = fits_create_file(fname_out);

julia&gt; fits_copy_file(fin, fout, true, true, true);

julia&gt; fits_get_hdu_num(fout)
2

julia&gt; fits_get_hdu_type(fout)
:binary_table

julia&gt; fits_movabs_hdu(fout, 1) # move to the primary HDU
:image_hdu

julia&gt; fits_read_key_str(fout, &quot;NAXIS&quot;)
(&quot;0&quot;, &quot;number of data axes&quot;)

julia&gt; fits_read_key_str(fout, &quot;KEY1&quot;)
(&quot;1&quot;, &quot;First keyword&quot;)

julia&gt; foreach(close, (fin, fout));</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/514542da3a88d61ed2d08e6a390298fcbe94716c/src/CFITSIO.jl#L2802-L2853">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_copy_hdu" href="#CFITSIO.fits_copy_hdu"><code>CFITSIO.fits_copy_hdu</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_copy_hdu(fin::FITSFile, fout::FITSFile, morekeys::Integer = 0)</code></pre><p>Copy the current HDU from the input file <code>fin</code> and append it to the output file <code>fout</code>. Space may be reserved for <code>morekeys</code> additional keywords in the output header.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname_in = joinpath(mktempdir(), &quot;test_in.fits&quot;);

julia&gt; fname_out = joinpath(mktempdir(), &quot;test_out.fits&quot;);

julia&gt; fin = fits_create_file(fname_in);

julia&gt; fits_create_empty_img(fin)

julia&gt; fits_write_key(fin, &quot;KEY1&quot;, 1, &quot;First keyword&quot;)

julia&gt; fout = fits_create_file(fname_out);

julia&gt; fits_copy_hdu(fin, fout)

julia&gt; fits_get_hdu_num(fout)
1

julia&gt; fits_get_hdu_type(fout)
:image_hdu

julia&gt; fits_read_key_str(fout, &quot;NAXIS&quot;)
(&quot;0&quot;, &quot;number of data axes&quot;)

julia&gt; fits_read_key_str(fout, &quot;KEY1&quot;)
(&quot;1&quot;, &quot;First keyword&quot;)

julia&gt; foreach(close, (fin, fout))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/514542da3a88d61ed2d08e6a390298fcbe94716c/src/CFITSIO.jl#L2884-L2920">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_copy_data" href="#CFITSIO.fits_copy_data"><code>CFITSIO.fits_copy_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_copy_data(fin::FITSFile, fout::FITSFile)</code></pre><p>Copy the data (not the header) from the current HDU in <code>fin</code> to the current HDU in <code>fout</code>. This will overwrite pre-existing data in the output HDU.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname_in = joinpath(mktempdir(), &quot;test_in.fits&quot;);

julia&gt; fname_out = joinpath(mktempdir(), &quot;test_out.fits&quot;);

julia&gt; fin = fits_create_file(fname_in);

julia&gt; fits_create_img(fin, Int64, (2, 2))

julia&gt; fits_write_pix(fin, [1, 1], 4, [1, 2, 3, 4])

julia&gt; fits_write_key(fin, &quot;KEY1&quot;, 1, &quot;First keyword&quot;)

julia&gt; fout = fits_create_file(fname_out);

julia&gt; fits_create_img(fout, Int64, (2, 2));

julia&gt; fits_copy_data(fin, fout)

julia&gt; B = zeros(Int64, 2, 2);

julia&gt; fits_read_pix(fout, [1, 1], 4, B);

julia&gt; B
2×2 Matrix{Int64}:
 1  3
 2  4

julia&gt; fits_read_key_str(fout, &quot;KEY1&quot;) # the header isn&#39;t copied
ERROR: CFITSIO has encountered an error. Error code 202: keyword not found in header
[...]

julia&gt; foreach(close, (fin, fout))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/514542da3a88d61ed2d08e6a390298fcbe94716c/src/CFITSIO.jl#L2945-L2986">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_delete_hdu" href="#CFITSIO.fits_delete_hdu"><code>CFITSIO.fits_delete_hdu</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_delete_hdu(f::FITSFile)</code></pre><p>Delete the HDU from the FITS file and shift the following HDUs forward. If <code>f</code> is the primary HDU in the file then it&#39;ll be replaced by a null primary HDU with no data and minimal header information.</p><p>Return a symbol to indicate the type of the new current HDU. Possible symbols are: <code>:image_hdu</code>, <code>:ascii_table</code>, or <code>:binary_table</code>. The value of <code>hduNum</code> must range between 1 and the value returned by <a href="#CFITSIO.fits_get_num_hdus"><code>fits_get_num_hdus</code></a>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_create_binary_tbl(f, 0, [(&quot;col1&quot;, &quot;1J&quot;), (&quot;col2&quot;, &quot;1E&quot;)])

julia&gt; fits_get_hdu_num(f)
2

julia&gt; fits_get_hdu_type(f)
:binary_table

julia&gt; fits_delete_hdu(f) # delete the binary table HDU
:image_hdu

julia&gt; fits_get_hdu_num(f)
1

julia&gt; fits_get_hdu_type(f)
:image_hdu

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/514542da3a88d61ed2d08e6a390298fcbe94716c/src/CFITSIO.jl#L2319-L2358">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_write_chksum" href="#CFITSIO.fits_write_chksum"><code>CFITSIO.fits_write_chksum</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_write_chksum(f::FITSFile)</code></pre><p>Compute and write the <code>DATASUM</code> and <code>CHECKSUM</code> keyword values for the CHDU into the current header. If the keywords already exist, their values will be updated only if necessary (i.e., if the file has been modified since the original keyword values were computed).</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_binary_tbl(f, 0, [(&quot;col1&quot;, &quot;1J&quot;, &quot;units&quot;)]);

julia&gt; fits_write_col(f, 1, 1, 1, [1, 2, 3]);

julia&gt; fits_write_chksum(f); # write the checksum keywords

julia&gt; fits_read_key_str(f, &quot;DATASUM&quot;, comment = nothing)
(&quot;6&quot;, nothing)

julia&gt; fits_read_key_str(f, &quot;CHECKSUM&quot;, comment = nothing)
(&quot;9TbBESbA9SbACSbA&quot;, nothing)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/514542da3a88d61ed2d08e6a390298fcbe94716c/src/CFITSIO.jl#L5793-L5820">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_update_chksum" href="#CFITSIO.fits_update_chksum"><code>CFITSIO.fits_update_chksum</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_update_chksum(f::FITSFile)</code></pre><p>Update the <code>CHECKSUM</code> keyword value in the CHDU, assuming that the <code>DATASUM</code> keyword exists and already has the correct value.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_binary_tbl(f, 0, [(&quot;col1&quot;, &quot;1J&quot;, &quot;units&quot;)]);

julia&gt; fits_write_col(f, 1, 1, 1, [1, 2, 3]);

julia&gt; fits_write_chksum(f); # write the checksum keywords

julia&gt; fits_read_key_str(f, &quot;DATASUM&quot;, comment = nothing)
(&quot;6&quot;, nothing)

julia&gt; fits_read_key_str(f, &quot;CHECKSUM&quot;, comment = nothing)
(&quot;5UdCATZB7TdBATZB&quot;, nothing)

julia&gt; fits_write_key(f, &quot;TEST&quot;, &quot;test&quot;, &quot;test comment&quot;); # modify the header

julia&gt; fits_update_chksum(f); # update the CHECKSUM keyword

julia&gt; fits_read_key_str(f, &quot;CHECKSUM&quot;, comment = nothing)
(&quot;Y3amY0UjY0ZjY0Zj&quot;, nothing)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/514542da3a88d61ed2d08e6a390298fcbe94716c/src/CFITSIO.jl#L5833-L5866">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_verify_chksum" href="#CFITSIO.fits_verify_chksum"><code>CFITSIO.fits_verify_chksum</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_verify_chksum(f::FITSFile)</code></pre><p>Verify if the checksum of the data and the HDU matches the stored values. Returns a tuple of <code>CFITSIO.ChecksumVerificationStatus</code> values, indicating the status of the data and HDU checksums. For either value, a status of <code>MISSING</code> indicates that the corresponding keyword is not present, while a status of <code>MISMATCH</code> indicates that the keyword is present but the value is incorrect. Finally, a value of <code>VERIFIED</code> indicates that the checksum was validated successfully.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_binary_tbl(f, 0, [(&quot;col1&quot;, &quot;1J&quot;, &quot;units&quot;)]);

julia&gt; fits_write_col(f, 1, 1, 1, [1, 2, 3]);

julia&gt; fits_verify_chksum(f) # no checksum keywords present
(CFITSIO.MISSING, CFITSIO.MISSING)

julia&gt; fits_write_chksum(f); # write the checksum keywords

julia&gt; fits_verify_chksum(f)
(CFITSIO.VERIFIED, CFITSIO.VERIFIED)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/514542da3a88d61ed2d08e6a390298fcbe94716c/src/CFITSIO.jl#L5880-L5910">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../file/">« File</a><a class="docs-footer-nextpage" href="../header/">Header »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Thursday 5 June 2025 06:22">Thursday 5 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
