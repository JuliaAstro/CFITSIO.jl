<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Header · CFITSIO.jl</title><meta name="title" content="Header · CFITSIO.jl"/><meta property="og:title" content="Header · CFITSIO.jl"/><meta property="twitter:title" content="Header · CFITSIO.jl"/><meta name="description" content="Documentation for CFITSIO.jl."/><meta property="og:description" content="Documentation for CFITSIO.jl."/><meta property="twitter:description" content="Documentation for CFITSIO.jl."/><meta property="og:url" content="https://juliaastro.github.io/CFITSIO.jl/header/"/><meta property="twitter:url" content="https://juliaastro.github.io/CFITSIO.jl/header/"/><link rel="canonical" href="https://juliaastro.github.io/CFITSIO.jl/header/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CFITSIO.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../types/">Type Conversions</a></li><li><a class="tocitem" href="../file/">File</a></li><li><a class="tocitem" href="../hdu/">HDU</a></li><li class="is-active"><a class="tocitem" href>Header</a><ul class="internal"><li><a class="tocitem" href="#Header-Keyword-Routines"><span>Header Keyword Routines</span></a></li></ul></li><li><a class="tocitem" href="../image/">Image</a></li><li><a class="tocitem" href="../table/">Table</a></li><li><a class="tocitem" href="../misc/">Miscellaneous</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Header</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Header</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaAstro/CFITSIO.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/master/docs/src/header.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Header-Keyword-Routines"><a class="docs-heading-anchor" href="#Header-Keyword-Routines">Header Keyword Routines</a><a id="Header-Keyword-Routines-1"></a><a class="docs-heading-anchor-permalink" href="#Header-Keyword-Routines" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_copy_header" href="#CFITSIO.fits_copy_header"><code>CFITSIO.fits_copy_header</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_copy_header(fin::FITSFile, fout::FITSFile)</code></pre><p>Copy the header (not the data) associated with the current HDU from <code>fin</code> to <code>fout</code>. If the current HDU in <code>fout</code> is not empty, it will be closed and a new HDU will be appended. An empty output HDU will be created with the header but no data.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname_in = joinpath(mktempdir(), &quot;test_in.fits&quot;);

julia&gt; fname_out = joinpath(mktempdir(), &quot;test_out.fits&quot;);

julia&gt; fin = fits_create_file(fname_in);

julia&gt; fits_create_empty_img(fin)

julia&gt; fits_write_key(fin, &quot;KEY1&quot;, 1, &quot;First keyword&quot;)

julia&gt; fout = fits_create_file(fname_out);

julia&gt; fits_copy_header(fin, fout)

julia&gt; fits_read_key_str(fout, &quot;NAXIS&quot;)
(&quot;0&quot;, &quot;number of data axes&quot;)

julia&gt; fits_read_key_str(fout, &quot;KEY1&quot;)
(&quot;1&quot;, &quot;First keyword&quot;)

julia&gt; foreach(close, (fin, fout))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L2078-L2109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_delete_key" href="#CFITSIO.fits_delete_key"><code>CFITSIO.fits_delete_key</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_delete_key(f::FITSFile, keyname::String)</code></pre><p>Delete the keyword named <code>keyname</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_write_key(f, &quot;KEY1&quot;, 1, &quot;First keyword&quot;)

julia&gt; fits_read_key_str(f, &quot;KEY1&quot;)
(&quot;1&quot;, &quot;First keyword&quot;)

julia&gt; fits_delete_key(f, &quot;KEY1&quot;) # delete the keyword

julia&gt; fits_read_key_str(f, &quot;KEY1&quot;)
ERROR: CFITSIO has encountered an error. Error code 202: keyword not found in header
[...]

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L2006-L2032">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_delete_record" href="#CFITSIO.fits_delete_record"><code>CFITSIO.fits_delete_record</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_delete_record(f::FITSFile, keynum::Integer)</code></pre><p>Delete the keyword record at the specified index.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_write_key(f, &quot;KEY1&quot;, 1, &quot;First keyword&quot;)

julia&gt; fits_read_key_str(f, &quot;KEY1&quot;)
(&quot;1&quot;, &quot;First keyword&quot;)

julia&gt; fits_delete_record(f, 7) # delete the keyword

julia&gt; fits_read_key_str(f, &quot;KEY1&quot;)
ERROR: CFITSIO has encountered an error. Error code 202: keyword not found in header
[...]

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1972-L1998">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_hdr2str" href="#CFITSIO.fits_hdr2str"><code>CFITSIO.fits_hdr2str</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_hdr2str(f::FITSFile, nocomments::Bool=false)</code></pre><p>Return the header of the CHDU as a string. If <code>nocomments</code> is <code>true</code>, comment cards are stripped from the output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L2047-L2052">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_get_hdrspace" href="#CFITSIO.fits_get_hdrspace"><code>CFITSIO.fits_get_hdrspace</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_get_hdrspace(f::FITSFile) -&gt; (keysexist, morekeys)</code></pre><p>Return the number of existing keywords (not counting the END keyword) and the amount of space currently available for more keywords.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_clobber_file(fname);

julia&gt; fits_create_img(f, Int32, (2, 2));

julia&gt; nkeywords, _ = fits_get_hdrspace(f)
(8, -1)

julia&gt; [fits_read_keyn(f, i) for i in 1:nkeywords]
8-element Vector{Tuple{String, String, String}}:
 (&quot;SIMPLE&quot;, &quot;T&quot;, &quot;file does conform to FITS standard&quot;)
 (&quot;BITPIX&quot;, &quot;32&quot;, &quot;number of bits per data pixel&quot;)
 (&quot;NAXIS&quot;, &quot;2&quot;, &quot;number of data axes&quot;)
 (&quot;NAXIS1&quot;, &quot;2&quot;, &quot;length of data axis 1&quot;)
 (&quot;NAXIS2&quot;, &quot;2&quot;, &quot;length of data axis 2&quot;)
 (&quot;EXTEND&quot;, &quot;T&quot;, &quot;FITS dataset may contain extensions&quot;)
 (&quot;COMMENT&quot;, &quot;&quot;, &quot;  FITS (Flexible Image Transport System) format is defined in &#39;Astronomy&quot;)
 (&quot;COMMENT&quot;, &quot;&quot;, &quot;  and Astrophysics&#39;, volume 376, page 359; bibcode: 2001A&amp;A...376..359H&quot;)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L868-L898">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_modify_comment" href="#CFITSIO.fits_modify_comment"><code>CFITSIO.fits_modify_comment</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_modify_comment(f::FITSFile, keyname::String, comment::String)</code></pre><p>Modify the comment of an existing keyword <code>keyname</code> in the FITS header. If the keyword does not exist, an error is raised.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_write_key(f, &quot;KEY1&quot;, 1, &quot;First keyword&quot;)

julia&gt; fits_read_key_str(f, &quot;KEY1&quot;)
(&quot;1&quot;, &quot;First keyword&quot;)

julia&gt; fits_modify_comment(f, &quot;KEY1&quot;, &quot;Modified comment&quot;)

julia&gt; fits_read_key_str(f, &quot;KEY1&quot;)
(&quot;1&quot;, &quot;Modified comment&quot;)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1928-L1954">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_modify_name" href="#CFITSIO.fits_modify_name"><code>CFITSIO.fits_modify_name</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_modify_name(f::FITSFile, oldname::String, newname::String)</code></pre><p>Modify the name of a keyword in the FITS header, retaining the value and comment associated with it.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_write_key(f, &quot;OLDKEY&quot;, 42, &quot;This is an old keyword&quot;)

julia&gt; fits_read_key_str(f, &quot;OLDKEY&quot;)
(&quot;42&quot;, &quot;This is an old keyword&quot;)

julia&gt; fits_modify_name(f, &quot;OLDKEY&quot;, &quot;NEWKEY&quot;)

julia&gt; fits_read_key_str(f, &quot;NEWKEY&quot;)
(&quot;42&quot;, &quot;This is an old keyword&quot;)

julia&gt; fits_read_key_str(f, &quot;OLDKEY&quot;)
ERROR: CFITSIO has encountered an error. Error code 202: keyword not found in header
[...]

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1880-L1910">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_read_key_lng" href="#CFITSIO.fits_read_key_lng"><code>CFITSIO.fits_read_key_lng</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_read_key_lng(f::FITSFile, keyname::String)</code></pre><p>Read the value of a keyword as a <code>Clong</code>, as well as the comment associated with the keyword.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_img(f, Int32, (100, 100));

julia&gt; fits_read_key_lng(f, &quot;NAXIS1&quot;)
(100, &quot;length of data axis 1&quot;)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L965-L984">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_read_key_str" href="#CFITSIO.fits_read_key_str"><code>CFITSIO.fits_read_key_str</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_read_key_str(f::FITSFile, keyname::String)</code></pre><p>Read the value associated with the keyword as a <code>String</code>, along with the comment.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_read_key_str(f, &quot;SIMPLE&quot;)
(&quot;T&quot;, &quot;file does conform to FITS standard&quot;)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L923-L941">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_read_key_unit" href="#CFITSIO.fits_read_key_unit"><code>CFITSIO.fits_read_key_unit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_read_key_unit(f::FITSFile, keyname::String)</code></pre><p>Read the physical unit of the keyword <code>keyname</code> in the header.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_write_key(f, &quot;Velocity&quot;, 2.0, &quot;Velocity of the object&quot;)

julia&gt; fits_write_key_unit(f, &quot;Velocity&quot;, &quot;m/s&quot;)

julia&gt; fits_read_key_unit(f, &quot;Velocity&quot;)
&quot;m/s&quot;

julia&gt; fits_read_keyword(f, &quot;Velocity&quot;)
(&quot;2.&quot;, &quot;[m/s] Velocity of the object&quot;)

julia&gt; close(f)</code></pre><p>See also <a href="#CFITSIO.fits_write_key_unit"><code>fits_write_key_unit</code></a> to write a unit to a keyword.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1204-L1231">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_read_keyn" href="#CFITSIO.fits_read_keyn"><code>CFITSIO.fits_read_keyn</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_read_keyn(f::FITSFile, keynum::Int) -&gt; (name, value, comment)</code></pre><p>Return the nth header record in the CHU. The first keyword in the header is at <code>keynum = 1</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_read_keyn(f, 1)
(&quot;SIMPLE&quot;, &quot;T&quot;, &quot;file does conform to FITS standard&quot;)

julia&gt; fits_read_keyn(f, 3)
(&quot;NAXIS&quot;, &quot;0&quot;, &quot;number of data axes&quot;)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1151-L1172">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_read_keyword" href="#CFITSIO.fits_read_keyword"><code>CFITSIO.fits_read_keyword</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_read_keyword(f::FITSFile, keyname::String) -&gt; (value, comment)</code></pre><p>Return the specified keyword value and comment (as a tuple of strings), throws and error if the keyword is not found.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_read_keyword(f, &quot;SIMPLE&quot;)
(&quot;T&quot;, &quot;file does conform to FITS standard&quot;)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1055-L1074">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_read_record" href="#CFITSIO.fits_read_record"><code>CFITSIO.fits_read_record</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_read_record(f::FITSFile, keynum::Int)::String</code></pre><p>Return the <code>keynum</code>-th header record in the CHU. The first keyword in the header is at <code>keynum = 1</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_read_record(f, 1)
&quot;SIMPLE  =                    T / file does conform to FITS standard&quot;

julia&gt; fits_read_record(f, 3)
&quot;NAXIS   =                    0 / number of data axes&quot;

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1098-L1120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_update_key" href="#CFITSIO.fits_update_key"><code>CFITSIO.fits_update_key</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_update_key(f::FITSFile, key::String, value, comment::Union{String,Ptr{Nothing},Nothing} = nothing)</code></pre><p>Update the value of an existing keyword in the FITS header, or add a new keyword if it does not exist. This function is a convenience wrapper that calls the appropriate <code>ffuk*</code> function based on the type of <code>value</code>.</p><p>If <code>comment</code> is provided, it is added to the keyword comment field. If <code>value</code> is <code>Nothing</code>, the keyword is set to a null value. If <code>value</code> is a string, it is checked to be ASCII compliant. If <code>value</code> is a floating-point number, it is written as a double-precision value. If <code>value</code> is a boolean, it is written as an integer (1 for true, 0 for false).</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_update_key(f, &quot;NEWKEY&quot;, 2, &quot;This is a new keyword&quot;)

julia&gt; fits_read_key_str(f, &quot;NEWKEY&quot;)
(&quot;2&quot;, &quot;This is a new keyword&quot;)

julia&gt; fits_update_key(f, &quot;NEWKEY&quot;, 3.14, &quot;Updated value&quot;)

julia&gt; fits_read_key_str(f, &quot;NEWKEY&quot;)
(&quot;3.14&quot;, &quot;Updated value&quot;)

julia&gt; fits_update_key(f, &quot;NEWKEY&quot;, true, &quot;Boolean value&quot;)

julia&gt; fits_read_key_str(f, &quot;NEWKEY&quot;)
(&quot;T&quot;, &quot;Boolean value&quot;)

julia&gt; fits_update_key(f, &quot;NEWKEY&quot;, &quot;Value&quot;, &quot;String value&quot;)

julia&gt; fits_read_key_str(f, &quot;NEWKEY&quot;)
(&quot;Value&quot;, &quot;String value&quot;)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1711-L1753">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_write_comment" href="#CFITSIO.fits_write_comment"><code>CFITSIO.fits_write_comment</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_write_comment(f::FITSFile, comment::String)</code></pre><p>Append to the keyword <code>COMMENT</code> in the FITS header. If the keyword does not exist, it is created.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_write_comment(f, &quot;This is a comment&quot;)

julia&gt; fits_read_record(f, 7)
&quot;COMMENT This is a comment&quot;

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1638-L1659">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_write_date" href="#CFITSIO.fits_write_date"><code>CFITSIO.fits_write_date</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_write_date(f::FITSFile)</code></pre><p>Write the current date and time into the FITS header. If a DATE keyword already exists, it is replaced by the new value. The date is written in the format <code>YYYY-MM-DDThh:mm:ss</code> (ISO 8601).</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_write_date(f)

julia&gt; fits_read_key_str(f, &quot;DATE&quot;)
(&quot;2025-05-28T10:41:08&quot;, &quot;file creation date (YYYY-MM-DDThh:mm:ss UT)&quot;)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1608-L1630">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_write_history" href="#CFITSIO.fits_write_history"><code>CFITSIO.fits_write_history</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_write_history(f::FITSFile, history::String)</code></pre><p>Append to the keyword <code>HISTORY</code> in the FITS header. If the keyword does not exist, it is created.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_write_history(f, &quot;This is a history entry&quot;)

julia&gt; fits_read_record(f, 7)
&quot;HISTORY This is a history entry&quot;

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1675-L1695">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_write_key" href="#CFITSIO.fits_write_key"><code>CFITSIO.fits_write_key</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_write_key(f::FITSFile, keyname::String, value, comment::Union{String, Nothing} = nothing)</code></pre><p>Write a keyword of the appropriate data type into the CHU. If <code>comment</code> is <code>nothing</code>, the keyword is written without a comment.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_write_key(f, &quot;NEWKEY&quot;, 2, &quot;This is a new keyword&quot;)

julia&gt; fits_read_key_str(f, &quot;NEWKEY&quot;)
(&quot;2&quot;, &quot;This is a new keyword&quot;)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1514-L1535">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_write_key_unit" href="#CFITSIO.fits_write_key_unit"><code>CFITSIO.fits_write_key_unit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_write_key_unit(f::FITSFile, keyname::String, unit::String)</code></pre><p>Write the physical units string into an existing keyword record. The keyword must already exist in the header. The unit string is enclosed in square brackets at the beginning of the keyword comment field.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_write_key(f, &quot;Velocity&quot;, 2.0, &quot;Velocity of the object&quot;)

julia&gt; fits_write_key_unit(f, &quot;Velocity&quot;, &quot;m/s&quot;)

julia&gt; fits_read_key_unit(f, &quot;Velocity&quot;)
&quot;m/s&quot;

julia&gt; fits_read_keyword(f, &quot;Velocity&quot;)
(&quot;2.&quot;, &quot;[m/s] Velocity of the object&quot;)

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1563-L1590">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CFITSIO.fits_write_record" href="#CFITSIO.fits_write_record"><code>CFITSIO.fits_write_record</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fits_write_record(f::FITSFile, card::String)</code></pre><p>Write a user specified keyword record into the CHU. This is a low–level routine which can be used to write any arbitrary record into the header. It is not recommended to use this function unless you know what you are doing. It is typically used to write hierarchical keywords in the ESO convention, which allows keyword names longer than 8 characters. It is also used to write comments or history entries directly into the header. If the keyword already exists, it is replaced by the new value. If the keyword does not exist, it is added to the header.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fname = joinpath(mktempdir(), &quot;test.fits&quot;);

julia&gt; f = fits_create_file(fname);

julia&gt; fits_create_empty_img(f)

julia&gt; fits_write_record(f, &quot;HIERARCH ESO OBS ID = &#39;12345&#39;&quot;)

julia&gt; fits_read_record(f, 7)
&quot;HIERARCH ESO OBS ID = &#39;12345&#39;&quot;

julia&gt; close(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/CFITSIO.jl/blob/1ee37d3a98ca34058db53e59ead7f03ddbb2fc19/src/CFITSIO.jl#L1835-L1863">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../hdu/">« HDU</a><a class="docs-footer-nextpage" href="../image/">Image »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Thursday 5 June 2025 06:41">Thursday 5 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
